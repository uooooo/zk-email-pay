# 技術要件・成功基準

## 基本要件（前提）
- 宛先: メールアドレスをウォレットアドレスのように扱い、送金可能。
- 非保有者対応: 受取側がウォレット未保有でも資産を受け取れる。
- ガスレス: 手数料や鍵管理などの専門知識を意識させず、体験はガスレス。
- メール中心UX: 送金作成→受取→完了まで、受取側はメール操作中心で完結。

## 対応チェーン/資産（MVP）
- チェーン: Base
- 通貨: USDC（ERC20）。将来拡張で ETH/他ERC20。

## コア機能（MVP）
- 送金作成（Persona1＝既存ウォレット保有者向けWeb）：
  - 宛先メール/金額/トークン入力、確認、送信。
  - 誤送対策: 受取前の取消、期限付与（expiry）。
- 受取（Persona2＝未保有者）：
  - 受取招待メールを受信、メール返信（および最小限のワンクリックWeb）で受取完了。
  - 初回はEmail Wallet自動作成（アカウント生成/初期化）。
- ガスレス実行:
  - リレーヤーがトランザクション費用を肩代わり（後述Fee回収方式）。
- 証跡/通知:
  - 送信/受取/取消イベントをオンチェーン/メールで通知。

## 非機能要件
- セキュリティ: DKIM検証をZKで検証（最小開示）、リプレイ防止（nonce/expiry/Nullifier）、ドメイン鍵の管理指針。
- 可用性: リレーヤー/プルーバは冗長構成、メール受信経路の監視、再試行とDLQ。
- 運用性: イベント/メトリクス（配信成功率、証明生成時間、最終確定時間）を可視化。
- プライバシー: メールアドレスはオンチェーンに秘匿（コミットメント/ポインタ利用）。
- 拡張性: 送金以外の拡張（NFT送信/スワップ/請求）をExtensionsで拡張可能。

## 成功指標（例）
- 送金完了率、平均/中央値所要時間（作成→受取→確定）。
- 受取リンク（または返信）→完了の転換率（Persona2）。
- 取消成功率/期限切れ率、誤送救済率。
- サポート問い合わせ率の低さ。

## 制約/設計上の判断
- ZKメール: `docs/zkemail/zk-email-overview.md`の設計方針に準拠。DKIM中心、本文は最小限の構造化項目のみ回路で扱う。
- Email Wallet: 既存の回路/コントラクト/リレーヤー設計（`docs/zkemail/zkemail-emailwallet/*`）を活用し、Unclaimed Funds → Claimの標準パターンを採用。
- 鍵取得: MVPは「信頼済みフェッチャ」+ キャッシュ、将来的にDNSSECや独自DKIM Registry（ECDSA署名型）へ拡張。

