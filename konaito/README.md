# zkemail-wallet-paypay (企画ドラフト)

本リポジトリは「zkEmail × Email Wallet」でステーブルコイン（例: USDC）の送受金を、メールアドレスだけで安全・簡単に行える世界を目指す企画ドラフトです。現時点では実装は行わず、コンセプトと要件整理にフォーカスします。

## 概要
- 目的: メールを起点にZKで正当性を証明しつつ、誰でもガスレスでステーブルコインをやり取りできるUXを提供。
- コア技術: zkEmail（DKIM/ヘッダ/本文の制約充足をZK証明）、アカウントアブストラクション（AA）、メタトランザクション/Paymaster、USDC等のステーブルコイン。
- ステータス: 企画定義中（実装なし）。

## ビジョン
- メールアドレスだけで送受金可能、ガスや鍵管理を意識させない「当たり前の決済体験」を実現。
- ZKによりメール命令の真偽を検証し、プライバシーとUXを両立。

## 価値提案（Value Proposition）
- アドレス非依存: 相手のウォレットアドレスを知らなくても送金可能。
- ガスレス体験: 手数料はUSDC等から自動精算、ユーザーは負担を意識しない。
- プライバシー: メール本文はサーバ非保持、ZKで命令部分のみ証明。
- 回復性: メール起点のリカバリに加え、2FA/ソーシャル回復を段階的に検討。

## 想定ユーザー/ユースケース
- 個人送金: 友人や家族へメールでUSDCを送る。
- SMB請求: 請求メール→支払い完了で自動照合・入金管理を簡素化。
- 事業者ペイアウト: 報酬/キャッシュバックをメール一括配布、相手はリンクで受取完了。
- 開発者: 既存アプリに「メールで支払う/受け取る」ボタンを追加。

## コアフロー（MVP）
1) 送金
- 送金者がテンプレート化されたメール（to/amount/token/expiry/nonce）を作成
- クライアントが構造化データを生成し、ZKで正当性（送信者・内容）を証明
- リレー/Paymasterがガスを肩代わりしてUSDC送金

2) 受取
- 受取者はリンクを開き、初回は軽いセットアップ→ZK承認→残高反映

3) 請求
- 請求メール（QR/リンク付）を送付→支払者がリンクから承認→照合完了

4) 返金/拒否
- 未執行命令の取消・返金、上限越えトランザクションの手動承認

## 信頼・コンプライアンス設計（方向性）
- カストディ方針: 原則ノンカストディ（MVP）。企業向けはハイブリッドを検討。
- KYCレベル: L1（軽KYC）、高額/事業者はL2追加。制裁リスト/モニタリング/閾値レビュー。
- ルール例: 取引上限・遅延解除・地理的制限の適用可能性。

## 技術コンセプト（実装しない前提の設計）
- アイデンティティ: zkEmailでDKIM検証＋本文制約の充足をZK証明。生メールは非保持。
- ウォレット: AAベース推奨。メール→アカウント紐付けを初回受取時に確立。
- トランザクション: メタトランザクション＋Paymasterでガスレス。USDC単一対応から開始。
- メール命令スキーマ（最小）: from, to, amount, token, expiry, nonce, purpose。
- セキュリティ: 2FA（高額時必須）、送信ドメイン検証、上限・遅延解除、失効/取消機構。

## MVPスコープ
- チェーン: 手数料低＋USDC流動性の高いEVMを1つ選定（例: Base/Polygon 等、後日確定）。
- トークン: USDC（まず1種に限定）。
- フロー: 送金/受取、請求、返金、履歴、基本回復。
- ガスレス: 小額に限定（上限超は手動承認）。
- 管理: 事業者向け簡易ダッシュボード（入出金・ステータス）。
- 非対応: クロスチェーン、複数通貨、定期課金、DEX、NFT（将来検討）。

## KPI（仮）
- 受取成功率: 受取リンク→オンチェーン成功までの割合
- 送金完了率/中央値時間
- 初回体験完了率（<2分）
- 問い合わせ率/100件あたり
- 不正検知率と誤検知率
- 事業者導入までの平均日数

## リスクと対策
- メール乗っ取り: 高額は2FA必須、デバイスレピュテーション、上限/遅延。
- スプーフィング: DKIM/DMARC必須、ZKのドメイン制約、ブランド保護。
- UX摩擦: 命令テンプレ化、1クリック受取、ガスレス維持。
- 規制/税務: 限度額、国別ジオフェンス、事業者のみKYC強化。
- 可用性: メール遅延→再送/再検証、複数リレー冗長。

## フェーズ別ロードマップ（草案）
- P0: コンセプト検証（ユーザ面談、モック、命令スキーマ確定）
- P1: クローズドβ（単一チェーン/USDC、送受金＋請求）
- P2: 事業者β（ダッシュボード、CSV一括送金、Webhooks）
- P3: ガス最適化/回復強化（AA、ソーシャル回復）
- P4: 拡張（複数通貨/チェーン、定期課金、モバイルSDK）

## オープンな論点（決定が必要）
- 対象地域/市場: 日本中心か、先にグローバルか
- カストディ方針: 個人はノンカストディ、事業者はハイブリッドでよいか
- チェーン選定: 候補2〜3（手数料/安定性/法規）
- ステーブルコイン: USDC優先でよいか（代替候補）
- メールプロバイダ: Gmail/Yahoo/独自ドメインの対応範囲
- 上限と2FA: 1日/1取引の上限初期値、2FA適用ポリシー
- 事業者ユースケース: 請求とペイアウトの主打
- PayPay連携の意図: ネーミングか実連携か（日本戦略）

## リポジトリ構成（予定）
- docs/: 企画・仕様・PRDなどのドキュメント
- contracts/: スマートコントラクト（後日）
- relayer/: リレー/Paymaster（後日）
- web/: ユーザー向けUI（後日）
- examples/: メールテンプレ/命令スキーマ例

> 現時点では実装を含めず、docs/中心に進めます。

## 開発ポリシー（現状）
- 実装禁止: まずは要件/設計/リスク/KPIの合意を優先。
- Issue/PR: 企画・仕様の提案はIssueで議論→合意後にPRでREADME/ドキュメント更新。

## 参考資料
- zkEmail教科書（ドラフト）: `docs/zkemail-textbook-ja.md`
- 高レベル設計とワークフロー: `docs/architecture-workflows-ja.md`

## ライセンス
- 後日決定（現状は未設定）。

## コンタクト
- 議論・提案: Issueでお願いします。
- 共同検討したい論点があれば、README内「オープンな論点」に追記します。

---
このREADMEは企画ドラフトです。必要に応じてNotion/PRDテンプレートへ展開します。
