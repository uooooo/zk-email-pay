# 体験フロー: ペルソナ3（Email Wallet User）にETHを送る

## TL;DR
送信者はアプリでメールアドレス宛のETH送金を作成→プラットフォームが受取人に通知メール送信→受取人はリンクを開いて「受け取る」をタップ→プラットフォームがzkEmail証明を生成して安全に送金確定。受取人はメール転送不要で、技術的複雑さを感じることなくzkEmailの恩恵を受けられる。

---

本書は、あなたが「ペルソナ3（Email Wallet User）」の相手にETHを送るときの、分かりやすい体験フローをまとめたものです。技術的な詳細は意図的に省き、直感的な操作の流れだけを示します。ペルソナの定義は [`user/personas-ja.md`](../user/personas-ja.md) を参照してください。

## 前提
- 宛先は「ペルソナ3（Email Wallet User）」に該当する受取者（例: 相手のメールアドレスを宛先に指定）。
- あなたは送金者。金額は画面で自由に指定（例示では金額を固定しません）。
- ガスや鍵管理などの専門事項は画面に出さず、迷わず完了できる前提。
- **本フローは、ユーザー体験を最優先し、信頼できる「プラットフォーム」が裏側で技術的な処理を代行するモデルを想定しています。**

## 登場人物
- あなた（送金者）: 相手のメールアドレス宛にETHを送りたい人。
- 受取者（ペルソナ3: Email Wallet User）: メールを受け取り、Email Wallet を使って受取操作を行う人。
- プラットフォーム: 送金作成・通知・状態管理・**安全な送金確定処理**・返金処理を司るサービス。
- 台帳（ブロックチェーン）: 送金確定時に残高が移動する“公的な記録簿”。

## ハッピーパス（基本の流れ）
1) 送金の作成
- あなたは送金画面で、宛先に受取者のメールアドレス、通貨に「ETH」、金額と任意メモ・受取期限を入力し「送る」を押す。
- プラットフォームはこの送金のIDと受取リンクを生成。

2) 通知と待機
- 受取者に「あなた宛にETHの送金があります」というメールが届く（受取リンク付き）。
- あなたの画面ではステータスが「Notified（通知済/未受取）」になり、未受取の間は「取消」できる。

3) 受取
- 受取者は受取リンクを開き、金額・送金者（あなた）・期限を確認して「受け取る」をタップ。
- **プラットフォームが裏側で安全な検証処理を実行し**、台帳に確定記録します。これにより、ETHは受取者のEmail Wallet残高に反映されます。

4) 完了
- 両者に完了メールが届く。あなたの履歴は「Claimed（受取完了）」で固定。

## 受取側の分岐（ペルソナ3前提）
- 既にEmail Walletを利用中: 受取リンク→確認→「Email Walletで受け取る」→即時反映（既定）。
- まだEmail Walletの初期設定が未完了: 初回のみ簡単なセットアップ→そのまま受取→反映。
- 任意オプション（必要に応じて）: 外部の既存ウォレットに受け取る選択肢を提示してもよいが、既定はEmail Wallet。

## うまくいかなかった場合
- 宛先メールを間違えた
  - 受取前: あなたは「取消」で資金を自分に戻せる（即時または短時間で反映）。
  - 受取後: 通常は受取者の同意が必要。サポート経由の調整を案内。
- 受取期限切れ
  - プラットフォームが自動で失効→あなたへ返金。両者に通知。
- 受取者が受取拒否
  - ステータスは「Refused」→あなたへ返金。両者に通知。

## 状態遷移（わかりやすい語彙）
- Created（作成） → Notified（通知済） → Claimed（受取済）
- Notified → Canceled（送金者取消） → Refunded（返金済）
- Notified → Refused（受取拒否） → Refunded
- Notified → Expired（期限切れ） → Refunded

## 画面・メールのイメージ
- 通知メール（3さん向け）
  - 件名: 「あなた宛にETHの送金があります」
  - 本文: 送金者（あなた）、金額（ETH）、メモ（任意）、受取期限、受取ボタン
- 受取画面（3さん）
  - 1行説明→金額/送金者/期限→「受け取る」ボタン→完了メッセージ
- 送金者画面（あなた）
  - 宛先メール、金額（ETH）、メモ、期限を確認→「送る」
  - 一覧にステータス（Notified/Claimed/Refused/Expired/Refunded）と「取消」ボタン

## 安心・安全（体験としての配慮）
- 送信前に宛先メールと金額（ETH）を大きく表示して誤送を防止。
- 高額時はもう一段の確認（再タップ、または2段階確認）。
- すべての送金に「有効期限」と「一意の番号（ノンス）」を付与し、放置や再利用を防ぐ。

## 技術的な前提：なぜメールの転送が不要なのか
この体験フローでは、受取人がメールをどこかに転送する必要がありません。これは、ユーザー体験を最優先する「プラットフォーム中心モデル」を想定しているためです。

- **zkEmailの基本**: 本来、メールの送信元が本物であることを証明するには、メールのヘッダ情報（DKIM署名）を検証してゼロ知識証明を生成する必要があります。最も分散的な方法では、ユーザーが受信したメールを証明生成システム（プルーバー）に転送する操作が求められます。
- **本フローのモデル**: しかし、この手順は一般ユーザーにとって直感的ではありません。そこで本フローでは、信頼できる「プラットフォーム」が仲介役となります。プラットフォームは自身で通知メールを送信し、受取人が「受け取る」アクションを起こした際に、そのメールが正当なものであることを**自ら検証してゼロ知識証明を生成**します。
- **結論**: このモデルにより、ユーザーは「リンクをクリックするだけ」という簡単な操作で済み、技術的な複雑さを感じることなく、zkEmailによる安全な送金体験の恩恵を受けられます。

## 関連ドキュメント
- このフローの裏側にある技術的な仕組みについては、[技術解説: 送金受取フローの裏側](./architecture-receive-flow-ja.md) を参照してください。
- zkEmail全体のコンセプトや設計思想については、[zkEmail 教科書（企画・設計者向け）](./zkemail-textbook-ja.md) を参照してください。

---
このドキュメントは体験フローの説明に特化しています。必要であれば、画面モック（送金作成/確認/履歴、受取画面、通知文面）も追加します。
